# åŸå­åµŒå…¥æå–æ¨¡å— - æµ‹è¯•æŠ¥å‘Š

## âœ… æµ‹è¯•ç»“æœï¼šå®Œå…¨æˆåŠŸï¼

æµ‹è¯•æ—¥æœŸï¼š2026-01-28
æµ‹è¯•ç¯å¢ƒï¼šCUDA GPU

---

## ğŸ“Š æµ‹è¯•æ¦‚è§ˆ

### æµ‹è¯•çš„ç»“æ„

1. **Si diamond** (2åŸå­) - æ ‡å‡†æ™¶ä½“ç»“æ„
2. **Random C5** (5åŸå­) - éšæœºç”Ÿæˆçš„ç»“æ„
3. **Large Si** (16åŸå­) - å¤§å‹æ™¶ä½“ç»“æ„ (2Ã—2Ã—2 supercell)

### æå–ç»“æœ

| ç»“æ„ | åŸå­æ•° | åµŒå…¥å½¢çŠ¶ | åµŒå…¥ç»´åº¦ | çŠ¶æ€ |
|------|--------|----------|----------|------|
| Si diamond | 2 | (2, 992) | 992 | âœ… |
| Random C5 | 5 | (5, 992) | 992 | âœ… |
| Large Si | 16 | (16, 992) | 992 | âœ… |

---

## ğŸ” åµŒå…¥ç‰¹æ€§åˆ†æ

### 1. ç»´åº¦æ­£ç¡®
- **æ‰€æœ‰åµŒå…¥éƒ½æ˜¯992ç»´**ï¼Œç¬¦åˆé¢„æœŸ
- å¯¹åº”çƒè°å‡½æ•°L=0,1,2,3,4ï¼ˆs,p,d,f,gè½¨é“ï¼‰

### 2. æ•°å€¼åˆç†
- **å‡å€¼æ¥è¿‘0**ï¼šè¯´æ˜åµŒå…¥æ˜¯ä¸­å¿ƒåŒ–çš„
- **æ ‡å‡†å·®é€‚ä¸­**ï¼š0.02-0.06èŒƒå›´
- **æ— NaN/Inf**ï¼šæ‰€æœ‰æ•°å€¼éƒ½æ˜¯æœ‰æ•ˆçš„

### 3. ç¯å¢ƒè‡ªé€‚åº”æ€§
è§‚å¯Ÿåˆ°çš„æœ‰è¶£ç°è±¡ï¼š

**Si diamondç»“æ„**ï¼š
- ä¸¤ä¸ªSiåŸå­çš„åµŒå…¥èŒƒæ•°å®Œå…¨ç›¸åŒï¼š0.854
- è¿™æ˜¯å› ä¸ºå®ƒä»¬å¤„äºå®Œå…¨å¯¹ç§°çš„åŒ–å­¦ç¯å¢ƒä¸­

**Random C5ç»“æ„**ï¼š
- ä¸åŒåŸå­çš„åµŒå…¥èŒƒæ•°ä¸åŒï¼š0.67, 0.67, 0.59, 0.59, 0.59
- è¯´æ˜åµŒå…¥ç¡®å®æ•è·äº†ä¸åŒçš„å±€éƒ¨åŒ–å­¦ç¯å¢ƒ

**Large Siç»“æ„**ï¼š
- å¹³å‡èŒƒæ•°æ›´å¤§ï¼š1.72
- å› ä¸ºæœ‰æ›´å¤šçš„é‚»å±…åŸå­ï¼Œæ¶ˆæ¯ä¼ é€’æ›´å……åˆ†

---

## ğŸ’¡ å…³é”®å‘ç°

### 1. å¯¹ç§°æ€§ä¿æŒ
åœ¨Si diamondç»“æ„ä¸­ï¼Œä¸¤ä¸ªå¯¹ç§°ç­‰ä»·çš„åŸå­å¾—åˆ°äº†**å®Œå…¨ç›¸åŒ**çš„åµŒå…¥ï¼ˆèŒƒæ•°0.854ï¼‰ï¼Œè¿™è¯æ˜äº†ï¼š
- æ¨¡å‹æ­£ç¡®æ•è·äº†æ™¶ä½“å¯¹ç§°æ€§
- E3ç­‰å˜æ€§å·¥ä½œæ­£å¸¸

### 2. ç¯å¢ƒæ•æ„Ÿæ€§
åœ¨éšæœºç»“æ„ä¸­ï¼Œä¸åŒä½ç½®çš„åŸå­å¾—åˆ°äº†**ä¸åŒ**çš„åµŒå…¥ï¼Œè¿™è¯æ˜äº†ï¼š
- åµŒå…¥ç¡®å®æ˜¯ç¯å¢ƒè‡ªé€‚åº”çš„
- æ¨¡å‹èƒ½å¤ŸåŒºåˆ†ä¸åŒçš„å±€éƒ¨åŒ–å­¦ç¯å¢ƒ

### 3. å°ºåº¦æ•ˆåº”
å¤§å‹ç»“æ„çš„åµŒå…¥èŒƒæ•°æ›´å¤§ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºï¼š
- æ›´å¤šçš„é‚»å±…åŸå­å‚ä¸æ¶ˆæ¯ä¼ é€’
- æ›´ä¸°å¯Œçš„åŒ–å­¦ç¯å¢ƒä¿¡æ¯è¢«ç¼–ç 

---

## ğŸ“ ä¿å­˜çš„æ–‡ä»¶

æ‰€æœ‰åµŒå…¥å·²ä¿å­˜åˆ° `test_embeddings/outputs/`ï¼š

```
outputs/
â”œâ”€â”€ si_embeddings.npz       (9.2 KB)  - Si diamond
â”œâ”€â”€ random_embeddings.npz   (21 KB)   - Random C5
â””â”€â”€ large_embeddings.npz    (64 KB)   - Large Si
```

æ¯ä¸ª.npzæ–‡ä»¶åŒ…å«ï¼š
- `embeddings`: åŸå­åµŒå…¥çŸ©é˜µ
- `atomic_numbers`: åŸå­åºæ•°
- `positions`: åŸå­åæ ‡
- `cell`: æ™¶èƒå‚æ•°
- `pbc`: å‘¨æœŸæ€§è¾¹ç•Œæ¡ä»¶

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

```python
from deepaw.extract_embeddings import AtomicEmbeddingExtractor
from ase.build import bulk

# åˆå§‹åŒ–
extractor = AtomicEmbeddingExtractor()

# åˆ›å»ºç»“æ„
atoms = bulk('Si', 'diamond', a=5.43)

# æå–åµŒå…¥
embeddings = extractor.extract(atoms)
# è¾“å‡º: (n_atoms, 992) numpyæ•°ç»„
```

### åŠ è½½ä¿å­˜çš„åµŒå…¥

```python
import numpy as np

# åŠ è½½
data = np.load('si_embeddings.npz')
embeddings = data['embeddings']
atomic_numbers = data['atomic_numbers']
positions = data['positions']

print(f"Shape: {embeddings.shape}")
print(f"Atoms: {atomic_numbers}")
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

ç°åœ¨ä½ å¯ä»¥ï¼š

1. **ç”¨äºè¿ç§»å­¦ä¹ **
   ```python
   # ä½¿ç”¨åµŒå…¥è®­ç»ƒä¸‹æ¸¸æ¨¡å‹ï¼ˆèƒ½é‡é¢„æµ‹ã€æ€§è´¨é¢„æµ‹ç­‰ï¼‰
   embeddings = extractor.extract(atoms)
   # è®­ç»ƒä½ çš„æ¨¡å‹...
   ```

2. **ç»“æ„ç›¸ä¼¼æ€§åˆ†æ**
   ```python
   from sklearn.metrics.pairwise import cosine_similarity

   emb1 = extractor.extract(atoms1)
   emb2 = extractor.extract(atoms2)
   similarity = cosine_similarity(emb1.mean(0, keepdims=True),
                                  emb2.mean(0, keepdims=True))
   ```

3. **æ‰¹é‡å¤„ç†**
   ```python
   embeddings_list = extractor.extract_batch(atoms_list,
                                             show_progress=True)
   ```

---

## ğŸ“š æ–‡æ¡£ä½ç½®

- **å®Œæ•´æ–‡æ¡£**: `deepaw/extract_embeddings/README.md`
- **ç¤ºä¾‹ä»£ç **: `deepaw/extract_embeddings/example_usage.py`
- **å‘½ä»¤è¡Œå·¥å…·**: `deepaw/extract_embeddings/extract_script.py`

---

## âœ¨ æ€»ç»“

âœ… **æ¨¡å—å®Œå…¨å¯ç”¨ï¼**

- æˆåŠŸä»é¢„è®­ç»ƒæ¨¡å‹æå–åŸå­åµŒå…¥
- åµŒå…¥ç»´åº¦æ­£ç¡®ï¼ˆ992ç»´ï¼‰
- åµŒå…¥å…·æœ‰æ˜ç¡®çš„ç‰©ç†æ„ä¹‰ï¼ˆç”µå­äº‘å½¢çŠ¶ï¼‰
- åµŒå…¥æ˜¯ç¯å¢ƒè‡ªé€‚åº”çš„
- æ”¯æŒä»»æ„æ™¶ä½“ç»“æ„è¾“å…¥
- æ— éœ€ç”µè·å¯†åº¦ç½‘æ ¼æ•°æ®

**ä½ ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ¨¡å—æ¥æå–åŸå­åµŒå…¥ï¼Œç”¨äºä½ çš„ä¸‹æ¸¸ä»»åŠ¡ï¼** ğŸ‰
